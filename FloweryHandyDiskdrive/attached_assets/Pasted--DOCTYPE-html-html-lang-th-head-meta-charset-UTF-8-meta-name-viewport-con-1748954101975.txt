<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíñ 4 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå ‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© üíñ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Kanit', 'Inter', sans-serif;
            overflow-x: hidden;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="%23FF69B4" stroke="white" stroke-width="1"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') 16 16, auto;
            padding-bottom: 4rem;
            transition: transform 0.1s ease-in-out; /* For shaking effect */
        }
        body.is-shaking {
            animation: shakeBody 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shakeBody {
            10%, 90% { transform: translateX(-1px); }
            20%, 80% { transform: translateX(2px); }
            30%, 50%, 70% { transform: translateX(-3px); }
            40%, 60% { transform: translateX(3px); }
        }

        .particle-effect {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1;
        }
        .particle {
            position: absolute; font-size: 1.5rem; animation: floatUp linear infinite; opacity: 0;
        }
        @keyframes floatUp {
            0% { transform: translateY(10vh) translateX(-2vw) scale(0.4) rotate(-10deg); opacity: 0; }
            25% { opacity: 0.6; transform: translateX(2vw) scale(0.7) rotate(5deg); }
            50% { opacity: 0.8; transform: translateX(-1vw) scale(1) rotate(0deg); }
            75% { opacity: 0.5; transform: translateX(1vw) scale(0.8) rotate(-5deg); }
            100% { transform: translateY(-110vh) translateX(3vw) scale(1.2) rotate(10deg); opacity: 0; }
        }
        .card {
            background-color: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(15px);
            border-radius: 2rem; padding: 2rem; margin-bottom: 2.5rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1), 0 0 20px rgba(255, 105, 180, 0.35);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease;
            border: 1px solid rgba(255, 105, 180, 0.4);
            opacity: 0;
            animation: cardEntrance 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        main > .card:nth-child(1) { animation-delay: 0.1s; }
        main > .card:nth-child(2) { animation-delay: 0.25s; }
        main > .card:nth-child(3) { animation-delay: 0.4s; }
        main > .card:nth-child(4) { animation-delay: 0.55s; }
        main > .card:nth-child(5) { animation-delay: 0.7s; } 
        main > .card:nth-child(6) { animation-delay: 0.85s; }


        @keyframes cardEntrance {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .card:hover {
            transform: translateY(-12px) scale(1.03) perspective(1000px) rotateX(1.5deg) rotateY(1deg);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.2), 0 0 25px rgba(255, 105, 180, 0.6);
        }
        .gradient-bg-animated {
            background: linear-gradient(135deg, #fbc2eb, #a6c1ee, #fcc2e7, #b0c9f7);
            background-size: 400% 400%; animation: gradientAnimation 12s ease infinite;
        }
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; }
        }
        .button-shiny-pink {
            background: linear-gradient(45deg, #ff79c6, #f9a8d4); color: white;
            padding: 0.8rem 1.8rem; border-radius: 1rem; font-weight: bold; text-decoration: none;
            transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 121, 198, 0.4);
            border: none; display: inline-flex; align-items: center; gap: 0.5rem;
            position: relative; overflow: hidden;
        }
        .button-shiny-pink::before {
            content: ""; position: absolute; top: 0; left: -150%;
            width: 70%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            transform: skewX(-25deg);
            transition: left 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .button-shiny-pink:hover::before {
            left: 150%;
        }
        .button-shiny-pink:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.05); box-shadow: 0 6px 20px rgba(255, 121, 198, 0.6);
        }
        .button-shiny-pink:active:not(:disabled) { transform: translateY(-1px) scale(1.02); }
        .button-shiny-pink:disabled {
            background: #cccccc; cursor: not-allowed; opacity: 0.7;
        }
        
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px); animation: fadeIn 0.4s ease-out;
        }
        .modal-content {
            margin: 10% auto; padding: 30px; border-radius: 1.5rem;
            width: 90%; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative; animation: slideInModal 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideInModal { from { transform: translateY(-60px) scale(0.9); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
        
        .close-button {
            color: #ff79c6; position: absolute; top: 15px; right: 25px;
            font-size: 2.5rem; font-weight: bold; transition: transform 0.3s ease, color 0.3s ease;
            cursor: pointer; z-index: 1001;
        }
        .close-button:hover, .close-button:focus {
            color: #e60073; text-decoration: none; transform: rotate(180deg) scale(1.25);
        }

        #reasonModal .modal-content, #specialHeartModal .modal-content {
             background-color: #fff0f5; border: 3px dashed #ff79c6; max-width: 450px;
        }
        #specialHeartModal .modal-content {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            border: 5px solid #ff6b6b;
        }


        #letterModal .modal-content {
            background-color: #fffaf0; border: 5px solid #ffdab9;
            border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1), 0 0 0 10px rgba(255,218,185,0.3);
            max-width: 600px;
        }
        #letterPaper {
            font-family: 'Kanit', 'Inter', sans-serif; line-height: 1.8; font-size: 1.1rem;
            min-height: 250px; position: relative; overflow: hidden; text-align: left; padding: 1.5rem;
        }
        #letterPaper h3 { font-family: 'Kanit', sans-serif; }
        #typedLetterText { white-space: pre-wrap; }
        #letterHeartParticlesContainer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;
        }
        .typing-heart-particle {
            position: absolute; font-size: 0.8rem; color: #ff79c6;
            opacity: 0; animation: floatAndFade 1.2s ease-out forwards; user-select: none;
        }
        @keyframes floatAndFade {
            0% { transform: translateY(5px) scale(0.3) rotate(0deg); opacity: 1; }
            50% { transform: scale(0.8) rotate(15deg); }
            100% { transform: translateY(-40px) scale(0.5) rotate(-15deg); opacity: 0; }
        }
        
        #envelopeContainer {
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            position: relative;
        }
        #envelopeContainer:hover {
            transform: scale(1.1) rotate(-5deg);
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.7);
        }
        #envelopeContainer:hover i { color: #ff57b3; }
        #envelopeContainer.opening::before {
            content: ''; position: absolute; top: -10px; left: -10px; right: -10px; bottom: -10px;
            background: radial-gradient(circle, rgba(255,223,235,0.7) 0%, rgba(255,223,235,0) 70%);
            border-radius: 50%; animation: envelopeGlow 0.6s ease-out; z-index: -1;
        }
        @keyframes envelopeGlow {
            from { transform: scale(0); opacity: 0.7; }
            to { transform: scale(1.5); opacity: 0; }
        }

        .gallery-container { display: flex; align-items: center; justify-content: center; gap: 1rem; }
        .gallery-image { 
            max-width: 80%; max-height: 300px; border-radius: 1rem; 
            box-shadow: 0 8px 16px rgba(0,0,0,0.15); 
            transition: transform 0.4s ease, opacity 0.3s ease, box-shadow 0.4s ease;
        }
        .gallery-image:hover {
            transform: scale(1.05); 
            box-shadow: 0 12px 24px rgba(0,0,0,0.25); 
        }
        #imageCaption {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        #imageCaption.show {
            opacity: 1;
        }

        .gallery-button { background-color: rgba(255, 121, 198, 0.8); color: white; border: none; padding: 0.8rem; border-radius: 50%; font-size: 1.2rem; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; }
        .gallery-button:hover { background-color: #ff79c6; transform: scale(1.1); }
        
        .animated-text-glow {
            animation: textGlowSubtle 2.5s ease-in-out infinite alternate;
        }
        @keyframes textGlowSubtle {
            from { text-shadow: 0 0 3px #fff, 0 0 6px #fff, 0 0 9px #ff79c6, 0 0 12px #ff79c6; }
            to { text-shadow: 0 0 6px #fff, 0 0 9px #ff79c6, 0 0 12px #ff79c6, 0 0 15px #ff79c6; }
        }

        .icon-spin:hover { animation: spin 1s linear; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hearts-reason-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 1.5rem; padding: 1rem 0; }
        .heart-reason-button { background: none; border: none; color: #ff79c6; font-size: 3.5rem; cursor: pointer; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), color 0.3s ease; padding: 0.5rem; position: relative; }
        .heart-reason-button:hover { transform: scale(1.25) rotate(7deg); color: #ff57b3; }
        .heart-reason-button .fa-heart { filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2)); }
        .reason-modal-icon { font-size: 3rem; margin-bottom: 1rem; color: #ff79c6; animation: heartBeat 1.5s infinite; }
        @keyframes heartBeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #fde2f3; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #ff79c6, #f9a8d4); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #ff57b3, #f78ac7); }

        #giftBoxAnimationOverlay {
            position: fixed; inset: 0; display: none; flex-direction: column; 
            align-items: center; justify-content: center;
            background-color: rgba(0,0,0,0.85); z-index: 1005; backdrop-filter: blur(8px);
        }
        #giftCountdown {
            font-size: 4rem; color: white; font-weight: bold; margin-bottom: 2rem;
            text-shadow: 0 0 10px #ff79c6, 0 0 20px #ff79c6;
        }
        .gift-box-container {
            position: relative; width: 150px; height: 150px; display: none; 
        }
        .gift-box-base {
            width: 100px; height: 70px; background-color: #ff79c6;
            border: 3px solid #ff57b3; border-radius: 5px;
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        }
        .gift-box-lid {
            width: 110px; height: 40px; background-color: #f9a8d4;
            border: 3px solid #ff57b3; border-radius: 5px 5px 0 0;
            position: absolute; bottom: 65px;
            left: 50%; transform: translateX(-50%);
            transform-origin: bottom center;
            box-shadow: 0 -3px 8px rgba(0,0,0,0.15);
            transition: transform 0.5s ease-in-out;
        }
        .gift-box-lid.open {
            transform: translateX(-50%) translateY(-60px) rotate(-30deg) scale(1.1);
        }
        .gift-box-base::before, .gift-box-base::after {
            content: ''; position: absolute; background-color: #fff0f5;
        }
        .gift-box-base::before {
            width: 20px; height: 100%; top: 0; left: 50%; transform: translateX(-50%);
        }
        .gift-box-base::after {
            width: 100%; height: 20px; top: 50%; left: 0; transform: translateY(-50%);
        }
        .sparkle {
            position: absolute; width: 8px; height: 8px;
            background-color: gold; border-radius: 50%;
            opacity: 0; animation: sparkle-animation 0.8s ease-out forwards;
        }
        @keyframes sparkle-animation {
            0% { transform: scale(0.5) translateY(0); opacity: 1; }
            100% { transform: scale(1.2) translateY(-80px); opacity: 0; }
        }
        #giftIntermediateMessage {
            font-size: 1.5rem; color: white; text-align: center; margin-top: 2rem;
            padding: 1rem; background-color: rgba(255, 121, 198, 0.3); border-radius: 1rem;
            display: none; 
            text-shadow: 0 0 5px #000;
            animation: fadeInMessage 0.5s ease-out forwards;
        }
        @keyframes fadeInMessage {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animated-heart-icon {
            display: inline-block; 
            animation: faBeatSmall 1.2s infinite ease-in-out;
        }
        @keyframes faBeatSmall {
            0%, 100% { transform: scale(1); }
            10% { transform: scale(0.9); }
            30% { transform: scale(1.15); }
            50% { transform: scale(1); }
            70% { transform: scale(1.1); }
        }
        #confettiContainer {
            position: absolute; inset: 0; pointer-events: none; overflow: hidden; z-index: 5;
        }
        .confetti-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
            animation: confetti-fall 2.5s ease-out forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-10vh) rotate(0deg) scale(0.7); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg) scale(1); opacity: 0; }
        }
        
        /* 8th Heart Trigger Button */
        #eighthHeartTriggerButton {
            position: fixed;
            bottom: 30px; /* Position it nicely */
            left: 50%;
            transform: translateX(-50%) scale(0); /* Initially hidden and small */
            background-color: #ff4757; /* Bright red */
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px; /* Larger button */
            height: 80px;
            font-size: 3rem; /* Larger icon */
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.6);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1006; /* Above overlay, below modals if any overlap */
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
            animation: eighthHeartAppear 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            opacity: 0;
        }
        #eighthHeartTriggerButton.visible {
            transform: translateX(-50%) scale(1);
            opacity: 1;
        }
        #eighthHeartTriggerButton:hover {
            transform: translateX(-50%) scale(1.15);
            box-shadow: 0 12px 30px rgba(255, 71, 87, 0.8);
        }
        @keyframes eighthHeartAppear {
            from { transform: translateX(-50%) scale(0); opacity: 0; }
            to { transform: translateX(-50%) scale(1); opacity: 1; }
        }


    </style>
</head>
<body class="gradient-bg-animated min-h-screen flex flex-col items-center justify-center p-4 sm:p-6">
    <div class="particle-effect" id="particleEffectContainer"></div>

    <div id="giftBoxAnimationOverlay">
        <div id="giftCountdown"></div>
        <div class="gift-box-container" id="actualGiftBoxVisual">
            <div class="gift-box-lid" id="giftBoxLid"></div>
            <div class="gift-box-base"></div>
        </div>
        <div id="giftIntermediateMessage"></div>
    </div>

    <audio id="letterOpenSound" src="https://youtu.be/EBJf0slhj5A?si=v_qlEPguVHmo0xL9&t=48‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏Å‡πá‡∏à‡∏∞‡∏õ‡∏¥‡∏î" preload="auto"></audio>
    <audio id="specialHeartSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_202e7f6c70.mp3?filename=short-success-sound-glockenspiel-treasure-video-game-6346.mp3" preload="auto"></audio> 

    <button id="eighthHeartTriggerButton" style="display: none;"><i class="fas fa-heart"></i></button>


    <div class="w-full max-w-2xl mx-auto z-10">

        <header class="text-center mb-10 sm:mb-16">
            <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white animated-text-glow drop-shadow-lg">
                <i class="fas fa-heartbeat fa-beat" style="--fa-animation-duration: 1.5s; color: #ffd1dc;"></i>
                4 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå
                <i class="fas fa-gift icon-spin" style="color: #ffeb80;"></i>
            </h1>
            <p class="text-xl sm:text-2xl text-white mt-3 drop-shadow-md">
                ‡∏ñ‡∏∂‡∏á <input type="text" id="partnerNameInput" placeholder="‡∏≠‡πâ‡∏ß‡∏ô" class="font-semibold text-pink-200 bg-transparent border-b-2 border-pink-300 focus:outline-none focus:border-pink-100 placeholder-pink-300 text-center w-48"> ‡∏Ñ‡∏ô‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤
            </p>
        </header>

        <main>
            <section class="card text-center">
                <h2 class="text-2xl sm:text-3xl font-semibold text-pink-500 mb-6">
                    <i class="fas fa-envelope-open-heart mr-2 text-pink-400 animated-heart-icon"></i> ‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©...‡∏ñ‡∏∂‡∏á‡∏≠‡πâ‡∏ß‡∏ô
                </h2>
                <div id="envelopeContainer" class="cursor-pointer inline-block p-6 rounded-2xl hover:bg-pink-100 transition-colors duration-300">
                    <i class="fas fa-envelope text-7xl text-pink-400"></i>
                    <p class="mt-3 text-gray-600 italic text-lg">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÉ‡∏à‡πÄ‡∏Ñ‡πâ‡∏≤</p>
                </div>
            </section>

            <div id="letterModal" class="modal">
                <div class="modal-content">
                    <span class="close-button" id="closeLetterModalButton">√ó</span>
                    <div id="letterPaper">
                         <h3 class="text-2xl font-semibold text-pink-600 mb-4 text-center border-b-2 border-pink-200 pb-2">üíå ‡∏ñ‡∏∂‡∏á‡∏≠‡πâ‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤...</h3>
                        <p id="typedLetterText"></p>
                        <div id="letterHeartParticlesContainer"></div>
                    </div>
                </div>
            </div>

            <section class="card text-center">
                <h2 class="text-2xl sm:text-3xl font-semibold text-purple-500 mb-6">
                    <i class="fas fa-images mr-2 text-purple-400 animated-heart-icon"></i> ‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
                </h2>
                <div class="gallery-container">
                    <button id="prevImage" class="gallery-button"><i class="fas fa-chevron-left"></i></button>
                    <img id="galleryImage" src="https://img2.pic.in.th/pic/1738770715266.jpg"
                         alt="‡∏£‡∏π‡∏õ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏á ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡πÄ‡∏≠‡πà‡∏¢? üòä"
                         class="gallery-image"
                         onerror="this.onerror=null; this.src='https://placehold.co/500x350/CCCCCC/FFFFFF?text=‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡πâ‡∏≤';">
                    <button id="nextImage" class="gallery-button"><i class="fas fa-chevron-right"></i></button>
                </div>
                <p id="imageCaption" class="text-gray-600 italic mt-4">‡∏£‡∏π‡∏õ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏á ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡πÄ‡∏≠‡πà‡∏¢? üòä</p>
            </section>

            <section class="card">
                <h2 class="text-2xl sm:text-3xl font-semibold text-teal-500 mb-6 text-center">
                    <i class="fas fa-heart-circle-check mr-2 text-teal-400 animated-heart-icon"></i> 7 ‡∏î‡∏ß‡∏á‡πÉ‡∏à ‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏≠‡πâ‡∏ß‡∏ô
                </h2>
                <div class="hearts-reason-container">
                    <button class="heart-reason-button" data-reason-index="0"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="1"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="2"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="3"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="4"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="5"><i class="fas fa-heart"></i></button>
                    <button class="heart-reason-button" data-reason-index="6"><i class="fas fa-heart"></i></button>
                </div>
                <p class="text-center text-gray-500 italic mt-4">‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡∏ß‡∏á‡∏î‡∏π‡∏™‡∏¥...</p>
            </section>

            <div id="reasonModal" class="modal">
                <div class="modal-content">
                    <span class="close-button" id="closeReasonModalButton">√ó</span>
                    <div id="reasonModalIcon" class="reason-modal-icon"><i class="fas fa-heart"></i></div>
                    <h3 id="reasonModalTitle" class="text-2xl font-semibold text-pink-600 mb-3">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏≠‡πâ‡∏ß‡∏ô... ‡∏î‡∏ß‡∏á‡∏ó‡∏µ‡πà <span id="reasonHeartNumber"></span></h3>
                    <p id="reasonModalText" class="text-lg text-gray-700 leading-relaxed"></p>
                </div>
            </div>
            
            <div id="specialHeartModal" class="modal">
                <div class="modal-content">
                    <span class="close-button" id="closeSpecialHeartModalButton">√ó</span>
                    <div id="confettiContainer"></div> 
                    <div class="text-7xl text-red-500 mb-4 animate-pulse"><i class="fas fa-heart"></i></div>
                    <h3 class="text-3xl font-bold text-red-600 mb-4">üíñ ‡∏î‡∏ß‡∏á‡πÉ‡∏à‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡πâ‡∏≤! üíñ</h3>
                    <p id="specialHeartMessage" class="text-xl text-gray-700 leading-relaxed">‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡πâ‡∏ß‡∏ô‡∏ô‡∏£‡∏±‡∏Å‡∏Å‡∏°‡∏≤‡∏Å‡∏Å‡πÜ‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡∏à‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏∞‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
                </div>
            </div>


            <section id="loveJourneyCard" class="card">
                <h2 class="text-2xl sm:text-3xl font-semibold text-orange-500 mb-6 text-center">
                   <i class="fas fa-hourglass-half mr-2 text-orange-400 fa-spin" style="--fa-animation-duration: 3s;"></i> ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô
                </h2>
                <div class="text-center text-gray-700 text-lg space-y-2">
                    <p>‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 4 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2568 ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ...</p>
                    <p class="text-2xl sm:text-3xl md:text-4xl font-bold text-pink-500" id="timeElapsedDisplay">
                        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤...
                    </p>
                    <p id="detailedTimeElapsed" class="text-lg sm:text-xl text-gray-600"></p>
                </div>
                 <p class="mt-6 text-center text-pink-500 font-semibold">...‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ‚ù§Ô∏è...</p>
            </section>

            <section class="text-center my-8 card">
                <h2 class="text-2xl sm:text-3xl font-semibold text-red-500 mb-6">
                     <i class="fas fa-box-open mr-2 text-red-400 animated-heart-icon"></i> ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô!
                </h2>
                <button id="surpriseGiftButton" class="button-shiny-pink bg-red-500 hover:bg-red-600 text-2xl p-6 rounded-2xl transform hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-gift"></i>
                </button>
                 <p class="mt-3 text-gray-600 italic">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏™‡∏¥!</p>
            </section>

            <section class="card text-center">
                <h2 class="text-2xl sm:text-3xl font-semibold text-indigo-500 mb-4">
                    <i class="fas fa-music mr-2 text-indigo-400 icon-spin"></i> ‡πÄ‡∏û‡∏•‡∏á‡∏ô‡∏µ‡πâ...‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô
                </h2>
                <p class="text-gray-700 mb-6 text-lg">‡πÄ‡∏û‡∏•‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏≠‡πâ‡∏ß‡∏ô‡∏ô‡∏∞ ‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‚ù§Ô∏è</p>
                <a href="https://youtu.be/ULQVcDUJjvM?si=9gPpM_AmNF8hXb4R&t=5" target="_blank" class="button-shiny-pink">
                    <i class="fas fa-headphones-alt"></i> ‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á ‡∏Ñ‡∏π‡πà‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï - COCKTAIL ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
                </a>
                <input type="hidden" id="yourNameInput" value="‡πÄ‡∏Ñ‡πâ‡∏≤">
            </section>
        </main>

        <footer class="text-center mt-10 sm:mt-16 pb-8">
            <p class="text-white text-lg drop-shadow-md">
                ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡πÄ‡∏™‡∏°‡∏≠ ‡∏à‡∏≤‡∏Å <span id="footerYourName" class="font-semibold text-pink-200">‡πÄ‡∏Ñ‡πâ‡∏≤</span>
            </p>
            <p class="text-white text-sm mt-2 opacity-90">
                <i class="fas fa-heart" style="color: #ff79c6;"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ <i class="fas fa-heart" style="color: #ff79c6;"></i>
            </p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Particle Effect
            const particleContainer = document.getElementById('particleEffectContainer');
            const emojis = ['üíñ', 'üíú', 'üíï', 'üíó', 'üíì', 'üíû', '‚ú®', 'üåü', 'üéâ', 'üå∏', 'üéà', 'üéÄ', 'üéÅ'];
            const numParticles = 60;

            function createParticle() {
                if (!particleContainer) return;
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particle.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDuration = (Math.random() * 10 + 8) + 's';
                particle.style.animationDelay = Math.random() * 12 + 's';
                particle.style.fontSize = (Math.random() * 1.2 + 0.7) + 'rem';
                particle.style.color = `hsl(${Math.random() * 70 + 290}, 100%, ${Math.random() * 25 + 65}%)`;
                particleContainer.appendChild(particle);
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
             for (let i = 0; i < numParticles; i++) {
                createParticle();
            }
            setInterval(createParticle, 1500);

            // Name inputs
            const partnerNameInput = document.getElementById('partnerNameInput');
            const yourNameInput = document.getElementById('yourNameInput'); 
            const footerYourName = document.getElementById('footerYourName');
            const letterOpenSound = document.getElementById('letterOpenSound');
            const specialHeartSound = document.getElementById('specialHeartSound');


            function updateDynamicNames() {
                const partnerName = partnerNameInput.value || "‡∏≠‡πâ‡∏ß‡∏ô"; 
                const yourName = yourNameInput.value || "‡πÄ‡∏Ñ‡πâ‡∏≤"; 
                if (footerYourName) footerYourName.textContent = yourName;
                if (partnerNameInput.placeholder === "‡∏≠‡πâ‡∏ß‡∏ô" && partnerName !== "‡∏≠‡πâ‡∏ß‡∏ô" && partnerNameInput.value.trim() !== "") {
                    // User has typed something different from default
                } else if (partnerNameInput.value.trim() === "") {
                     partnerNameInput.placeholder = "‡∏≠‡πâ‡∏ß‡∏ô";
                }
                document.title = `üíñ 4 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå ‡∏Å‡∏±‡∏ö${partnerName}‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© üíñ`;
            }

            if(partnerNameInput) {
                partnerNameInput.addEventListener('input', updateDynamicNames);
                if (!partnerNameInput.value) {
                    partnerNameInput.placeholder = "‡∏≠‡πâ‡∏ß‡∏ô";
                }
            }
            if(yourNameInput && !yourNameInput.value) {
                yourNameInput.value = "‡πÄ‡∏Ñ‡πâ‡∏≤";
            }
             updateDynamicNames(); 


            // --- MODAL ELEMENTS ---
            const letterModal = document.getElementById('letterModal');
            const envelopeContainer = document.getElementById('envelopeContainer');
            const closeLetterModalButton = document.getElementById('closeLetterModalButton');
            const typedLetterText = document.getElementById('typedLetterText');
            const letterHeartParticlesContainer = document.getElementById('letterHeartParticlesContainer');

            const surpriseGiftButton = document.getElementById('surpriseGiftButton');

            const reasonModal = document.getElementById('reasonModal');
            const closeReasonModalButton = document.getElementById('closeReasonModalButton');
            const heartReasonButtons = document.querySelectorAll('.heart-reason-button');
            const reasonModalText = document.getElementById('reasonModalText');
            const reasonHeartNumber = document.getElementById('reasonHeartNumber');
            
            const specialHeartModal = document.getElementById('specialHeartModal');
            const closeSpecialHeartModalButton = document.getElementById('closeSpecialHeartModalButton');
            const confettiContainer = document.getElementById('confettiContainer');
            const eighthHeartTriggerButton = document.getElementById('eighthHeartTriggerButton');


            const giftBoxAnimationOverlay = document.getElementById('giftBoxAnimationOverlay');
            const giftBoxLid = document.getElementById('giftBoxLid');
            const actualGiftBoxVisual = document.getElementById('actualGiftBoxVisual');
            const giftCountdownDisplay = document.getElementById('giftCountdown');
            const giftIntermediateMessageDisplay = document.getElementById('giftIntermediateMessage');


            // --- LETTER MODAL LOGIC ---
            let currentLetterMessage = '';
            let typingInterval;
            let charIndex = 0;

            function typeLetter() {
                if (!typedLetterText || !currentLetterMessage) return;
                if (charIndex < currentLetterMessage.length) {
                    typedLetterText.innerHTML += currentLetterMessage.charAt(charIndex);
                    charIndex++;
                    if (currentLetterMessage.charAt(charIndex -1) !== ' ' && currentLetterMessage.charAt(charIndex -1) !== '\n' && Math.random() < 0.4) {
                        createTypingHeart();
                    }
                    if (typedLetterText.parentElement) {
                        typedLetterText.parentElement.scrollTop = typedLetterText.parentElement.scrollHeight;
                    }
                } else {
                    clearInterval(typingInterval);
                }
            }

            function createTypingHeart() {
                if (!letterHeartParticlesContainer || !typedLetterText) return;
                const heart = document.createElement('span');
                heart.classList.add('typing-heart-particle');
                heart.innerHTML = ['üíñ', 'üíï', 'üíó', 'üíì'][Math.floor(Math.random() * 4)];
                const lastCharRect = typedLetterText.lastChild ? (typedLetterText.lastChild.nodeType === Node.TEXT_NODE ? typedLetterText.getBoundingClientRect() : (typedLetterText.lastChild instanceof Element ? typedLetterText.lastChild.getBoundingClientRect() : typedLetterText.getBoundingClientRect())) : typedLetterText.getBoundingClientRect();
                const containerRect = letterHeartParticlesContainer.getBoundingClientRect();
                let x = Math.random() * (lastCharRect.width * 0.8) + (lastCharRect.left - containerRect.left) + (lastCharRect.width * 0.1);
                let y = (lastCharRect.bottom - containerRect.top) - (Math.random() * 30 + 20);
                heart.style.left = `${Math.max(0, Math.min(x, containerRect.width - 20))}px`;
                heart.style.top = `${Math.max(0, Math.min(y, containerRect.height - 20))}px`;
                letterHeartParticlesContainer.appendChild(heart);
                setTimeout(() => { heart.remove(); }, 1100);
            }

            if (envelopeContainer && letterModal && typedLetterText) {
                envelopeContainer.onclick = function() {
                    if (letterOpenSound) {
                        letterOpenSound.currentTime = 0;
                        letterOpenSound.play().catch(e => console.warn("Letter sound autoplay was prevented.", e));
                    }
                    const partnerName = partnerNameInput.value || "‡∏≠‡πâ‡∏ß‡∏ô";
                    const yourNameVal = yourNameInput.value || "‡πÄ‡∏Ñ‡πâ‡∏≤";
                    currentLetterMessage = `‡∏ñ‡∏∂‡∏á ${partnerName} ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤,\n\n‡πÄ‡∏ú‡∏•‡∏≠‡πÅ‡∏õ‡πä‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πá 4 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ô‡∏≠‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô\n\n${partnerName}‡∏£‡∏π‡πâ‡πÑ‡∏´‡∏°... ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö${partnerName} ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ${partnerName}‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç ‡∏Ñ‡∏∑‡∏≠‡∏û‡∏•‡∏±‡∏á‡∏ö‡∏ß‡∏Å ‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÜ\n\n‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤ ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ${partnerName}‡πÄ‡∏™‡∏°‡∏≠ ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å${partnerName}‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢\n\n‡πÄ‡∏Ñ‡πâ‡∏≤‡∏≤‡∏£‡∏±‡∏Å‡∏Å‡∏Å‡∏≠‡πâ‡∏ß‡∏ô‡∏ô‡∏ô‡πâ‡∏≤‡∏≤‡∏≤‡∏≤‡∏≤`;
                    this.classList.add('opening');
                    setTimeout(() => { this.classList.remove('opening'); }, 600);
                    typedLetterText.innerHTML = ''; charIndex = 0;
                    if(letterHeartParticlesContainer) letterHeartParticlesContainer.innerHTML = '';
                    setTimeout(() => {
                        letterModal.style.display = "block";
                        setTimeout(() => { typingInterval = setInterval(typeLetter, 60); }, 300); // Typing speed increased (80 -> 60)
                    }, 200); 
                }
            }
            if (closeLetterModalButton && letterModal) {
                closeLetterModalButton.onclick = function() {
                    letterModal.style.display = "none"; clearInterval(typingInterval);
                    if (letterOpenSound) letterOpenSound.pause();
                }
            }

            // --- GIFT BOX LOGIC ---
            if (surpriseGiftButton && giftBoxAnimationOverlay && giftBoxLid && actualGiftBoxVisual && giftCountdownDisplay && giftIntermediateMessageDisplay) {
                surpriseGiftButton.onclick = function() {
                    giftBoxAnimationOverlay.style.display = "flex";
                    actualGiftBoxVisual.style.display = "none"; 
                    giftIntermediateMessageDisplay.style.display = "none"; 
                    giftCountdownDisplay.style.display = "block"; 
                    giftBoxLid.classList.remove('open'); 

                    let countdown = 10;
                    giftCountdownDisplay.textContent = countdown;

                    const countdownInterval = setInterval(() => {
                        countdown--;
                        giftCountdownDisplay.textContent = countdown;
                        if (countdown < 0) { 
                            clearInterval(countdownInterval);
                            giftCountdownDisplay.style.display = "none";
                            actualGiftBoxVisual.style.display = "block"; 

                            const giftBoxContainer = actualGiftBoxVisual; 
                            if (giftBoxContainer) {
                                giftBoxContainer.querySelectorAll('.sparkle').forEach(s => s.remove());
                                for (let i = 0; i < 15; i++) {
                                    const sparkle = document.createElement('div');
                                    sparkle.classList.add('sparkle');
                                    sparkle.style.left = Math.random() * 80 + 10 + '%'; 
                                    sparkle.style.bottom = Math.random() * 20 + '%';
                                    sparkle.style.animationDelay = Math.random() * 0.3 + 's';
                                    giftBoxContainer.appendChild(sparkle);
                                }
                            }
                            
                            setTimeout(() => { 
                                giftBoxLid.classList.add('open');
                            }, 300); 

                            setTimeout(() => { 
                                actualGiftBoxVisual.style.display = "none"; 
                                giftIntermediateMessageDisplay.textContent = "‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏≠‡πâ‡∏ß‡∏ô‡∏à‡∏∞‡∏ä‡∏≠‡∏ö‡∏°‡∏±‡πâ‡∏¢‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô‡∏ô‡∏°‡∏≤‡∏Å‡∏Å";
                                giftIntermediateMessageDisplay.style.display = "block"; 
                                
                                setTimeout(() => { 
                                    giftBoxAnimationOverlay.style.display = "none";
                                    giftIntermediateMessageDisplay.style.display = "none"; 
                                    if (giftBoxContainer) {
                                         giftBoxContainer.querySelectorAll('.sparkle').forEach(s => s.remove());
                                    }
                                }, 4000); 
                            }, 1200); 
                        }
                    }, 1000); 
                }
            }
           
            // --- GALLERY LOGIC ---
            const images = [
                { src: "https://img2.pic.in.th/pic/1738770715266.jpg", caption: "‡∏£‡∏π‡∏õ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏á ‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡πÄ‡∏≠‡πà‡∏¢? üòä" },
                { src: "https://img5.pic.in.th/file/secure-sv1/1741103045900.jpg", caption: "‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ô‡∏µ‡πâ... ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏à‡∏±‡∏á‡πÄ‡∏•‡∏¢‡πÄ‡∏ô‡∏≠‡∏∞ ü•∞" },
                { src: "https://img5.pic.in.th/file/secure-sv1/1746283248995.jpg", caption: "‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡πâ‡∏ß‡∏ô ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î! üòò" }
            ];
            let currentImageIndex = 0;
            const galleryImage = document.getElementById('galleryImage');
            const imageCaption = document.getElementById('imageCaption');
            const prevButton = document.getElementById('prevImage');
            const nextButton = document.getElementById('nextImage');

            function updateGallery() {
                if (galleryImage && images.length > 0) {
                    galleryImage.style.opacity = 0; galleryImage.style.transform = 'scale(0.95)';
                    imageCaption.classList.remove('show');
                    setTimeout(() => {
                        galleryImage.src = images[currentImageIndex].src; 
                        galleryImage.alt = images[currentImageIndex].caption;
                        if(imageCaption) {
                            imageCaption.textContent = images[currentImageIndex].caption;
                            setTimeout(() => imageCaption.classList.add('show'), 50); 
                        }
                        galleryImage.style.opacity = 1; galleryImage.style.transform = 'scale(1)';
                    }, 300);
                }
            }
            if (prevButton) {
                prevButton.onclick = () => { currentImageIndex = (currentImageIndex - 1 + images.length) % images.length; updateGallery(); }
            }
            if (nextButton) {
                nextButton.onclick = () => { currentImageIndex = (currentImageIndex + 1) % images.length; updateGallery(); }
            }
            if (galleryImage) { updateGallery(); }

            // --- REASONS MODAL & SPECIAL 8TH HEART LOGIC ---
            const reasons = [
                "‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡∏Ç‡∏≠‡∏á‡∏≠‡πâ‡∏ß‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏™‡∏î‡πÉ‡∏™‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ üòä",
                "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏à‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡πâ‡∏ß‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÜ ü§ó",
                "‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ô‡πâ‡∏≠‡∏¢‡πÜ ‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢ üòÇ",
                "‡∏≠‡πâ‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡πÅ‡∏£‡∏á‡∏ú‡∏•‡∏±‡∏Å‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô üåü",
                "‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡πâ‡∏ß‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏≠‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤ ‡∏°‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏•‡∏¢ üíñ",
                "‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Ñ‡πà‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÉ‡∏Å‡∏•‡πâ‡πÜ üöóüí®",
                "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡πâ‡∏ß‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏≠‡πâ‡∏ß‡∏ô... ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏Ñ‡∏£ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏´‡∏°‡∏î‡∏´‡∏±‡∏ß‡πÉ‡∏à ‚ú®"
            ];
            const clickedReasonHearts = new Set();
            let specialHeartShown = false; 

            heartReasonButtons.forEach(button => {
                button.onclick = function() {
                    const reasonIndex = parseInt(this.dataset.reasonIndex);
                    if (reasonModalText) reasonModalText.textContent = reasons[reasonIndex];
                    if (reasonHeartNumber) reasonHeartNumber.textContent = reasonIndex + 1;
                    if (reasonModal) reasonModal.style.display = "block";

                    if (!specialHeartShown) {
                        clickedReasonHearts.add(reasonIndex);
                        if (clickedReasonHearts.size === 7) {
                            // Don't show immediately. Wait for modal close.
                        }
                    }
                }
            });
            
            if (closeReasonModalButton && reasonModal) {
                closeReasonModalButton.onclick = function() { 
                    reasonModal.style.display = "none"; 
                    // Check if it was the 7th unique heart being closed
                    if (!specialHeartShown && clickedReasonHearts.size === 7) {
                        specialHeartShown = true; 
                        document.body.classList.add('is-shaking');
                        setTimeout(() => {
                            document.body.classList.remove('is-shaking');
                            if(eighthHeartTriggerButton) {
                                eighthHeartTriggerButton.style.display = 'flex'; // Show the button
                                eighthHeartTriggerButton.classList.add('visible');
                            }
                        }, 600); // Duration of shake + a little delay
                    }
                }
            }

            if (eighthHeartTriggerButton) {
                eighthHeartTriggerButton.onclick = function() {
                    showSpecialHeart();
                    this.style.display = 'none'; // Hide the trigger button after click
                    this.classList.remove('visible');
                };
            }


            function showSpecialHeart() {
                if (specialHeartModal && specialHeartSound && confettiContainer) {
                    specialHeartModal.style.display = "block";
                    specialHeartSound.currentTime = 0;
                    specialHeartSound.play().catch(e => console.warn("Special heart sound autoplay was prevented.", e));
                    triggerConfetti();
                }
            }
            
            function triggerConfetti() {
                if (!confettiContainer) return;
                confettiContainer.innerHTML = ''; 
                const confettiColors = ['#ff79c6', '#f9a8d4', '#a6c1ee', '#ffd700', '#ff6b6b'];
                for (let i = 0; i < 80; i++) { 
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti-particle');
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = confettiColors[Math.floor(Math.random() * confettiColors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.style.width = Math.random() * 5 + 5 + 'px'; 
                    confetti.style.height = confetti.style.width;
                    confetti.style.transform = `translateY(-10vh) rotate(${Math.random() * 360}deg) scale(${Math.random() * 0.5 + 0.5})`;
                    confettiContainer.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }
            }

            if (closeSpecialHeartModalButton && specialHeartModal) {
                closeSpecialHeartModalButton.onclick = function() { 
                    specialHeartModal.style.display = "none"; 
                    if(specialHeartSound) specialHeartSound.pause();
                }
            }
            
            // --- TIME ELAPSED COUNTER LOGIC ---
            const startDate = new Date(2025, 1, 4, 0, 0, 0);
            const timeElapsedDisplay = document.getElementById('timeElapsedDisplay');
            const detailedTimeElapsed = document.getElementById('detailedTimeElapsed');
            const loveJourneyCard = document.getElementById('loveJourneyCard');
            const loveJourneyH2 = loveJourneyCard ? loveJourneyCard.querySelector('h2') : null;
            const loveJourneyP1 = loveJourneyCard ? loveJourneyCard.querySelector('.text-center.text-gray-700 p:first-of-type') : null;
            const loveJourneyFooterP = loveJourneyCard ? loveJourneyCard.querySelector('p.font-semibold') : null;

            function updateElapsedTime() {
                if (!timeElapsedDisplay || !detailedTimeElapsed || !loveJourneyCard) return;
                const now = new Date();
                if (now < startDate) {
                    let timeTo = startDate.getTime() - now.getTime(); if (timeTo < 0) timeTo = 0;
                    let s_to = Math.floor((timeTo / 1000) % 60); let m_to = Math.floor((timeTo / (1000 * 60)) % 60);
                    let h_to = Math.floor((timeTo / (1000 * 60 * 60)) % 24); let d_to = Math.floor(timeTo / (1000 * 60 * 60 * 24));
                    timeElapsedDisplay.textContent = `‡∏≠‡∏µ‡∏Å ${d_to} ‡∏ß‡∏±‡∏ô ${h_to} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á`; detailedTimeElapsed.textContent = `${m_to} ‡∏ô‡∏≤‡∏ó‡∏µ ${s_to} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
                    if (loveJourneyH2) loveJourneyH2.innerHTML = '<i class="fas fa-calendar-alt mr-2 text-orange-400 fa-beat"></i> ‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏™‡∏π‡πà‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤';
                    if (loveJourneyP1) loveJourneyP1.textContent = '‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 4 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2568:';
                    if (loveJourneyFooterP) loveJourneyFooterP.textContent = '‡∏≠‡∏î‡πÉ‡∏à‡∏£‡∏≠‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á‡∏ô‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡∏â‡∏•‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô! ü•≥';
                    return;
                }
                if (loveJourneyH2 && loveJourneyH2.innerHTML.includes('‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á')) {
                     loveJourneyH2.innerHTML = '<i class="fas fa-hourglass-half mr-2 text-orange-400 fa-spin" style="--fa-animation-duration: 3s;"></i> ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô';
                     if (loveJourneyP1) loveJourneyP1.textContent = '‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 4 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2568 ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ...';
                     if (loveJourneyFooterP) loveJourneyFooterP.textContent = '...‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ‚ù§Ô∏è...';
                }
                let diff = now.getTime() - startDate.getTime();
                let s = Math.floor((diff / 1000) % 60); let m = Math.floor((diff / (1000 * 60)) % 60);
                let h = Math.floor((diff / (1000 * 60 * 60)) % 24);
                let tempNow = new Date(now); let tempStart = new Date(startDate);
                let years = tempNow.getFullYear() - tempStart.getFullYear(); let months = tempNow.getMonth() - tempStart.getMonth();
                let days = tempNow.getDate() - tempStart.getDate();
                if (days < 0) { months--; days += new Date(tempNow.getFullYear(), tempNow.getMonth(), 0).getDate(); }
                if (months < 0) { years--; months += 12; }
                timeElapsedDisplay.textContent = `${years} ‡∏õ‡∏µ ${months} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${days} ‡∏ß‡∏±‡∏ô`;
                detailedTimeElapsed.textContent = `${h} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ${m} ‡∏ô‡∏≤‡∏ó‡∏µ ${s} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
            }
            if (timeElapsedDisplay && detailedTimeElapsed) { updateElapsedTime(); setInterval(updateElapsedTime, 1000); }

            window.onclick = function(event) {
                if (reasonModal && event.target == reasonModal) { 
                    reasonModal.style.display = "none"; 
                    // Check if it was the 7th unique heart being closed (moved logic here)
                    if (!specialHeartShown && clickedReasonHearts.size === 7) {
                        specialHeartShown = true; 
                        document.body.classList.add('is-shaking');
                        setTimeout(() => {
                            document.body.classList.remove('is-shaking');
                            if(eighthHeartTriggerButton) {
                                eighthHeartTriggerButton.style.display = 'flex'; 
                                eighthHeartTriggerButton.classList.add('visible');
                            }
                        }, 600); 
                    }
                }
                if (letterModal && event.target == letterModal) {
                    letterModal.style.display = "none"; clearInterval(typingInterval);
                    if(letterOpenSound) letterOpenSound.pause();
                }
                if (specialHeartModal && event.target == specialHeartModal) { 
                    specialHeartModal.style.display = "none";
                    if(specialHeartSound) specialHeartSound.pause();
                }
                if (giftBoxAnimationOverlay && event.target == giftBoxAnimationOverlay) { 
                     giftBoxAnimationOverlay.style.display = "none";
                     const giftBoxContainer = actualGiftBoxVisual;
                     if (giftBoxContainer) { 
                        giftBoxContainer.querySelectorAll('.sparkle').forEach(s => s.remove());
                     }
                }
            }
        });
    </script>
</body>
</html>
